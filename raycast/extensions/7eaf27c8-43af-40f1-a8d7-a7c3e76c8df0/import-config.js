"use strict";var u=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var x=(o,t)=>{for(var r in t)u(o,r,{get:t[r],enumerable:!0})},A=(o,t,r,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of w(t))!C.call(o,a)&&a!==r&&u(o,a,{get:()=>t[a],enumerable:!(c=b(t,a))||c.enumerable});return o};var v=o=>A(u({},"__esModule",{value:!0}),o);var O={};x(O,{default:()=>m});module.exports=v(O);var e=require("@raycast/api"),g=require("react");var y=require("@raycast/api");var h="leader-key-config";var G=1,L=process.platform==="win32"?"windows":"mac",S={mac:{browser:{label:"Safari",value:"/Applications/Safari.app"},fileManager:{label:"Finder",value:"/System/Library/CoreServices/Finder.app"},terminal:{label:"Terminal",value:"/System/Applications/Utilities/Terminal.app"},calculator:{label:"Calculator",value:"/System/Applications/Calculator.app"},notes:{label:"Notes",value:"/System/Applications/Notes.app"}},windows:{browser:{label:"Edge",value:"msedge.exe"},fileManager:{label:"Explorer",value:"explorer.exe"},terminal:{label:"Command Prompt",value:"cmd.exe"},calculator:{label:"Calculator",value:"calc.exe"},notes:{label:"Notepad",value:"notepad.exe"}}},i=S[L],_={type:"group",actions:[{id:"default-a",key:"a",type:"group",label:"Applications",actions:[{id:"default-ab",key:"b",type:"application",label:i.browser.label,value:i.browser.value},{id:"default-at",key:"t",type:"application",label:i.terminal.label,value:i.terminal.value},{id:"default-af",key:"f",type:"application",label:i.fileManager.label,value:i.fileManager.value},{id:"default-ac",key:"c",type:"application",label:i.calculator.label,value:i.calculator.value},{id:"default-an",key:"n",type:"application",label:i.notes.label,value:i.notes.value}]},{id:"default-u",key:"u",type:"group",label:"URLs",actions:[{id:"default-ug",key:"g",type:"url",label:"Google",value:"https://google.com"},{id:"default-uh",key:"h",type:"url",label:"GitHub",value:"https://github.com"}]}]};async function k(o){let t={root:o,version:G};await y.LocalStorage.setItem(h,JSON.stringify(t))}function I(){return Date.now().toString(36)+Math.random().toString(36).slice(2)}function R(o){function t(r,c=""){let a=I();if(r.type==="group"){let n=r;return{id:a,key:n.key,type:"group",label:n.label,actions:n.actions.map(l=>t(l,c+n.key)),...n.browser?{browser:n.browser}:{}}}else{let n=r;return{id:a,key:n.key,type:n.type,label:n.label,value:n.value,...n.browser?{browser:n.browser}:{}}}}return{type:"group",actions:o.actions.map(r=>t(r))}}async function f(o){try{let t=JSON.parse(o);if(!t||typeof t!="object")return{success:!1,error:"Invalid JSON: not an object"};if(t.type!=="group")return{success:!1,error:"Invalid config: root must have type 'group'"};if(!Array.isArray(t.actions))return{success:!1,error:"Invalid config: missing 'actions' array"};let r=R(t);return await k(r),{success:!0}}catch(t){return{success:!1,error:`Parse error: ${t instanceof Error?t.message:"Unknown error"}`}}}var d=require("fs"),s=require("react/jsx-runtime");function m(){let[o,t]=(0,g.useState)([]),[r,c]=(0,g.useState)("");async function a(){if(o.length===0){await(0,e.showToast)({style:e.Toast.Style.Failure,title:"No file selected"});return}try{let l=(0,d.readFileSync)(o[0],"utf-8"),p=await f(l);p.success?(await(0,e.showToast)({style:e.Toast.Style.Success,title:"Config imported successfully"}),await(0,e.popToRoot)()):await(0,e.showToast)({style:e.Toast.Style.Failure,title:"Import failed",message:p.error})}catch(l){let p=l instanceof Error?l.message:"Unknown error";await(0,e.showToast)({style:e.Toast.Style.Failure,title:"Failed to read file",message:p})}}async function n(){if(!r.trim()){await(0,e.showToast)({style:e.Toast.Style.Failure,title:"No JSON provided"});return}let l=await f(r);l.success?(await(0,e.showToast)({style:e.Toast.Style.Success,title:"Config imported successfully"}),await(0,e.popToRoot)()):await(0,e.showToast)({style:e.Toast.Style.Failure,title:"Import failed",message:l.error})}return(0,s.jsxs)(e.Form,{actions:(0,s.jsxs)(e.ActionPanel,{children:[(0,s.jsx)(e.Action,{title:"Import from File",onAction:a}),(0,s.jsx)(e.Action,{title:"Import from JSON Text",onAction:n})]}),children:[(0,s.jsx)(e.Form.Description,{text:"Import a Leader Key config.json file or paste JSON directly."}),(0,s.jsx)(e.Form.FilePicker,{id:"configFile",title:"Config File",allowMultipleSelection:!1,canChooseDirectories:!1,value:o,onChange:t}),(0,s.jsx)(e.Form.Separator,{}),(0,s.jsx)(e.Form.TextArea,{id:"jsonText",title:"Or Paste JSON",placeholder:'{"type": "group", "actions": [...]}',value:r,onChange:c})]})}
